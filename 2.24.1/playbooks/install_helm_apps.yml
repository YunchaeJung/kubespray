---
- name: Common tasks for every playbooks
  import_playbook: boilerplate.yml

- name: Gather facts
  import_playbook: facts.yml
  
- hosts: kube_control_plane[0]
  gather_facts: no
  roles:
    - name: helm-apps
      releases:
        - name: nfs-subdir-external-provisioner
          namespace: kube-system
          chart_ref: ../helm_chart/nfs-subdir-external-provisioner
          wait_timeout: "10m" # override the same option in `release_common_opts`